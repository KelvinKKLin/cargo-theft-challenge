unit <- UNIT_1
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(47.00,49.5),
xlim = c(-121,-124),
cex = 1,
col = "red",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Truck Units")
count = 2
for( BC_UNIT in BC_UNITS){
unit <- BC_UNIT[order(BC_UNIT$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
lines(unit_x,unit_y,type = "l", col = count)
count = count + 1
}
legend("bottomright", inset=.02, title="Truck Unit",
c("2","3","4","9","10","11"), fill=c(1,2,3,4,5,6) + 1, horiz=TRUE, cex=0.8)
unit <- UNIT_1
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(47.00,49.5),
xlim = c(-121,-124),
cex = 1,
col = "red",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Truck Units")
count = 2
for( BC_UNIT in BC_UNITS){
unit <- BC_UNIT[order(BC_UNIT$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
lines(unit_x,unit_y,type = "l", col = count)
count = count + 1
}
legend("bottomright", inset=.02, title="Truck Unit",
c("1","5","6","7","8"), fill=c(1,2,3,4,5) + 1, horiz=TRUE, cex=0.8)
unit <- UNIT_1
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Unit 1")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
unit <- UNIT_5
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Unit 5")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
# =============================================================================================
unit <- UNIT_6
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Unit 6")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
# =============================================================================================
unit <- UNIT_7
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Unit 7")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
# =============================================================================================
unit <- UNIT_8
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "BC Unit 8")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
time_diff
# =============================================================================================
# Plots fully Time sequence
unit <- UNIT_1
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
time_diff
unit <- UNIT_2
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
time_diff > 800
length(time_diff)
length(unit_x)
sum(TRUE)
sum(c(TRUE,TRUE))
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if(i < 5){
print(sum(x[i-4:i]))
sum(x[i:i+4])
if(sum(x[i-4:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:i+4]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
}
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if(i < 5){
print(sum(x[i-4:i]))
sum(x[i:i+4])
if(sum(x[i-4:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:i+4]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if(i >= 5){
print(sum(x[i-4:i]))
sum(x[i:i+4])
if(sum(x[i-4:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:i+4]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
upper = i+4
if(i >= 5){
print(sum(x[i-4:i]))
sum(x[i:i+4])
if(sum(x[lower:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print(sum(x[lower:i]))
print(sum(x[i:upper]))
if(sum(x[lower:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print(sum(x[lower:i]))
print(sum(x[i:upper]))
browser()
if(sum(x[lower:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
x
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print(sum(x[lower:i]))
print(sum(x[i:upper]))
browser()
if(sum(x[lower:i]) == 4 & x[i+1] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-1] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
ends
starts
dts
dts[i]
dts[i-1]
dts[i-2]
dts[i-3]
dts[i]
dts[i+1]
dts[i+2]
i
x[i]
x[i+1]
x[i+2]
x[i+3]
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print(sum(x[lower:i]))
print(sum(x[i:upper]))
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print((x[lower:i]))
print((x[i:upper]))
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
print(starts)
print(ends)
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if (i+4 == length(x)){
break
}
lower = i-4
middle = i
upper = i+4
if(i >= 5){
print((x[lower:i]))
print((x[i:upper]))
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
print(starts)
print(ends)
}
}
list(starts = starts, ends = ends)
}
Drive_SE(time_diff > 800, unit$tstamp)
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if (i+4 == length(x)){
break
}
lower = i-4
middle = i
upper = i+4
if(i >= 5){
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
cycles <- Drive_SE(time_diff > 800, unit$tstamp)
cycles
cycles$starts
cycles$ends
cycles$starts - cycles$ends
cycles$starts[cycles[-length(cycles$starts)]] - cycles$ends
cycles$starts[-length(cycles$starts)] - cycles$ends
cycles$ends - cycles$starts[-length(cycles$starts)]
cycles$ends - cycles$starts[-length(cycles$starts)] / 60
as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60
as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2
hist(as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2)
hist(as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2)
# Import dataset
carthage <-  read.csv("ITM_20190121.csv")
carthage$tstamp <- as.POSIXct(strptime(carthage$CollectionTimestamp, '%Y-%M-%d %H:%M:%S'))
carthage <- carthage[,-11]
carthage <- carthage[!is.na(carthage$tstamp),]
carthage$Latitude <- as.numeric(as.character(carthage$Latitude))
carthage$Longitude <-  as.numeric(as.character(carthage$Longitude))
carthage <- carthage[!is.na(carthage$Latitude),]
carthage <- carthage[!is.na(carthage$Longitude),]
# =============================================================================================
unit <- UNIT_5
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
plot(unit_x,unit_y,type = "l",
ylim = c(min(unit_y),max(unit_y)),
xlim = c(min(unit_x),max(unit_x)),
cex = 1,
col = "black",
xlab = "Longitude",
ylab = "Latitude",
main = "Toronto Unit 2")
points(unit_x[time_diff > 800],unit_y[time_diff > 800], pch = 20, cex = 0.5, col ="red")
# Calculate driving start and end points
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if (i+4 == length(x)){
break
}
lower = i-4
middle = i
upper = i+4
if(i >= 5){
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
cycles <- Drive_SE(time_diff > 800, unit$tstamp)
hist(as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2)
time_diff
plot(time_diff, type = "l")
plot(time_diff < 3600, type = "l")
plot(time_diff < 5000, type = "l")
plot(time_diff < 1000, type = "l")
plot(time_diff, type = "l")
plot(log(time_diff), type = "l")
unit <- UNIT_1
unit <- unit[order(unit$tstamp),]
unit_x <- unit$Longitude
unit_y <- unit$Latitude
time_diff <- as.numeric(diff(unit$tstamp))
# Calculate driving start and end points
Drive_SE <- function(x,dts ){
starts <- c()
ends <- c()
for(i in 1:length(x)) {
if (i+4 == length(x)){
break
}
lower = i-4
middle = i
upper = i+4
if(i >= 5){
if(sum(x[lower:i]) == 4 & x[i+4] == FALSE){
starts <- append(starts,dts[i])
}
if(sum(x[i:upper]) == 4 & x[i-4] == FALSE){
ends <- append(ends,dts[i])
}
}
}
list(starts = starts, ends = ends)
}
cycles <- Drive_SE(time_diff > 800, unit$tstamp)
hist(cycles)
boxplot(cycles)
plot(log(time_diff), type = "l")
hist(as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2)
plot(as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]) / 60^2)
plot(as.numeric())as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]
as.numeric(cycles$ends - cycles$starts[-length(cycles$starts)]
)
plot(log(time_diff), type = "l")
plot(sin(log(time_diff)), type = "l")
plot(sin(log(time_diff))[1:100], type = "l")
plot(sin(time_diff)[1:100], type = "l")
plot(sin(time_diff)[1:1000], type = "l")
plot(y = sin(time_diff)[1:1000], x = unit$tstamp[-length(unit_x)][1:1000] ,type = "l")
plot(y = sin(time_diff)[1:4000], x = unit$tstamp[-length(unit_x)][1:4000] ,type = "l")
plot(y = sin(time_diff)[1:3000], x = unit$tstamp[-length(unit_x)][1:3000] ,type = "l")
plot(y = sin(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = cos(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = log(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = -log(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = -cos(time_diff)[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = -log(cos(time_diff))[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = cos(log(time_diff))[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = cos((time_diff))[1:2000], x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = cos((time_diff))[1:2000] + 1, x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin((time_diff))[1:2000] + 1, x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = tan((time_diff))[1:2000] + 1, x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin((time_diff))[1:2000] + 1, x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
plot(y = sin((time_diff))[1:2000] + 1, x = unit$tstamp[-length(unit_x)][1:2000] ,type = "l")
